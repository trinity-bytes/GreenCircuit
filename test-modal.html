<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Modal</title>
    <link rel="stylesheet" href="src/styles/main.css" />
    <style>
      body {
        padding: 50px;
      }
      #test-area {
        width: 800px;
        height: 500px;
        border: 2px solid #333;
        background: #f5f5f5;
        position: relative;
        cursor: crosshair;
      }
    </style>
  </head>
  <body>
    <h1>Test del Modal de Agregar Nodo</h1>
    <p>Click en el √°rea gris para abrir el modal</p>

    <div id="test-area"></div>

    <script>
      const testArea = document.getElementById("test-area");

      testArea.addEventListener("click", (e) => {
        const rect = testArea.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        console.log("Click en:", x, y);
        showModal(x, y);
      });

      function showModal(x, y) {
        // Crear overlay
        const overlay = document.createElement("div");
        overlay.className = "modal-overlay";
        overlay.id = "test-modal";

        // Crear modal
        const modal = document.createElement("div");
        modal.className = "node-modal";

        modal.innerHTML = `
                <div class="modal-header">
                    <h3>‚ûï Agregar Nuevo Nodo</h3>
                    <button class="modal-close" onclick="document.getElementById('test-modal').remove()">‚úñ</button>
                </div>
                
                <div class="modal-body">
                    <div class="form-group">
                        <label for="node-name">Nombre del punto:</label>
                        <input type="text" id="node-name" value="Punto A">
                    </div>

                    <div class="form-group">
                        <label for="node-type">Tipo de zona:</label>
                        <select id="node-type">
                            <option value="residencial">üèòÔ∏è Residencial</option>
                            <option value="comercial">üè¢ Comercial</option>
                            <option value="industrial">üè≠ Industrial</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="node-waste">Cantidad de residuos (kg):</label>
                        <input type="number" id="node-waste" value="50" min="10" max="200">
                    </div>

                    <div class="form-info">
                        <p><strong>Coordenadas:</strong> X: ${x.toFixed(
                          0
                        )}, Y: ${y.toFixed(0)}</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('test-modal').remove()">Cancelar</button>
                    <button class="btn-confirm" id="btn-add-node">‚úÖ Agregar Nodo</button>
                </div>
            `;

        overlay.appendChild(modal);
        document.body.appendChild(overlay);

        // Esperar y agregar evento
        setTimeout(() => {
          const btn = document.getElementById("btn-add-node");
          console.log("Bot√≥n encontrado:", btn);

          if (btn) {
            btn.addEventListener("click", () => {
              console.log("¬°Bot√≥n clickeado!");
              alert(
                "¬°Funciona! Valores:\n" +
                  "Nombre: " +
                  document.getElementById("node-name").value +
                  "\n" +
                  "Tipo: " +
                  document.getElementById("node-type").value +
                  "\n" +
                  "Residuos: " +
                  document.getElementById("node-waste").value
              );
              overlay.remove();
            });
          } else {
            console.error("No se encontr√≥ el bot√≥n");
          }
        }, 10);
      }
    </script>
  </body>
</html>
