<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GreenCircuit - Optimizaci√≥n de Rutas de Recolecci√≥n</title>
    <meta
      name="description"
      content="Optimizaci√≥n de rutas de recolecci√≥n de residuos urbanos usando el Problema del Agente Viajero (TSP)"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="src/styles/main.css" />

    <!-- Cytoscape.js desde CDN -->
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
  </head>

  <body>
    <!-- CONTENEDOR PRINCIPAL DE LA APP -->
    <div class="app-container">
      <!-- HEADER CON WIZARD INTEGRADO -->
      <header class="app-header">
        <div class="app-logo">
          <span class="app-logo-icon">üå±</span>
          <span class="app-logo-text">GreenCircuit</span>
        </div>

        <!-- WIZARD PROGRESS EN HEADER -->
        <div class="wizard-progress-header">
          <div class="wizard-steps">
            <div class="wizard-step active" data-step="1">
              <div class="wizard-step-number">1</div>
              <div class="wizard-step-label">Configuraci√≥n</div>
            </div>
            <div class="wizard-step-line"></div>
            <div class="wizard-step" data-step="2">
              <div class="wizard-step-number">2</div>
              <div class="wizard-step-label">Generaci√≥n</div>
            </div>
            <div class="wizard-step-line"></div>
            <div class="wizard-step" data-step="3">
              <div class="wizard-step-number">3</div>
              <div class="wizard-step-label">Visualizaci√≥n</div>
            </div>
            <div class="wizard-step-line"></div>
            <div class="wizard-step" data-step="4">
              <div class="wizard-step-number">4</div>
              <div class="wizard-step-label">Ejecuci√≥n</div>
            </div>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <a href="landing.html" class="btn btn-outline btn-sm"> ‚ÑπÔ∏è Ayuda </a>
          <span class="text-secondary text-sm">Optimizaci√≥n TSP</span>
        </div>
      </header>

      <!-- MAIN CONTENT CENTRADO -->
      <main class="app-main app-main--scroll">
        <div class="container-narrow">
          <!-- SECCI√ìN 1: CONFIGURACI√ìN -->
          <section
            id="config-section"
            class="content-section animate-fade-in-up delay-200"
          >
            <div class="section-header">
              <div>
                <div class="section-heading">
                  <div class="section-step-badge">1</div>
                  <h2 class="section-title">Configuraci√≥n del Grafo</h2>
                </div>
                <p class="section-subtitle section-subtitle-offset">
                  Define el n√∫mero de puntos de recolecci√≥n para optimizar
                </p>
              </div>
            </div>

            <div class="card mt-6">
              <div class="card-body">
                <div class="form-group">
                  <label for="input-n" class="form-label">
                    <strong
                      >¬øCu√°ntos puntos de recolecci√≥n deseas optimizar?</strong
                    >
                  </label>
                  <div class="flex items-center gap-4">
                    <input
                      type="number"
                      id="input-n"
                      class="form-input form-input--counter"
                      min="8"
                      max="16"
                      value="10"
                      placeholder="Ej: 10"
                    />
                    <span class="text-secondary text-sm"
                      >puntos (entre 8 y 16)</span
                    >
                  </div>
                  <small class="form-helper">
                    üí° <strong>Recomendaci√≥n:</strong> Comienza con 10 puntos
                    para una ejecuci√≥n r√°pida. Valores mayores a 12 pueden
                    tardar varios segundos.
                  </small>
                </div>

                <button id="btn-config" class="btn btn-primary btn-lg w-full">
                  ‚úÖ Continuar
                </button>
              </div>
            </div>

            <div id="config-status" class="mt-4"></div>
          </section>

          <!-- SECCI√ìN 2: GENERACI√ìN (Inicialmente oculta) -->
          <section id="generation-section" class="content-section hidden">
            <div class="section-header">
              <div>
                <div class="section-heading">
                  <div class="section-step-badge">2</div>
                  <h2 class="section-title">Generaci√≥n del Grafo</h2>
                </div>
                <p class="section-subtitle section-subtitle-offset">
                  Elige c√≥mo distribuir los puntos en el mapa
                </p>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-4 mt-6">
              <button id="btn-random" class="card hover-lift">
                <div class="card-emoji">üé≤</div>
                <h3 class="card-heading">Aleatorio</h3>
                <p class="card-description">
                  Distribuci√≥n aleatoria con separaci√≥n m√≠nima
                </p>
              </button>

              <button id="btn-random-circular" class="card hover-lift">
                <div class="card-emoji">‚≠ï</div>
                <h3 class="card-heading">Circular</h3>
                <p class="card-description">
                  Puntos distribuidos en un c√≠rculo uniforme
                </p>
              </button>

              <button id="btn-random-grid" class="card hover-lift">
                <div class="card-emoji">‚äû</div>
                <h3 class="card-heading">Grid</h3>
                <p class="card-description">
                  Distribuci√≥n en cuadr√≠cula regular
                </p>
              </button>
            </div>

            <div id="generation-status" class="mt-4"></div>
          </section>

          <!-- SECCI√ìN 3: VISUALIZACI√ìN DEL GRAFO -->
          <section id="graph-section" class="content-section">
            <div class="section-header">
              <div>
                <div class="section-heading">
                  <div class="section-step-badge">3</div>
                  <h2 class="section-title">Visualizaci√≥n del Grafo</h2>
                </div>
                <p class="section-subtitle section-subtitle-offset">
                  Explora y edita el grafo generado
                </p>
              </div>
            </div>

            <div id="graph-info" class="card card-gradient mb-4 hidden">
              <div class="card-body">
                <div id="graph-stats"></div>
              </div>
            </div>

            <div class="graph-wrapper mt-6">
              <div id="graph-container"></div>

              <!-- Toolbar flotante -->
              <div class="floating-toolbar">
                <button
                  id="btn-fit-view"
                  class="btn btn-icon btn-ghost"
                  title="Ajustar vista"
                >
                  üîç
                </button>
                <button
                  id="btn-reset-view"
                  class="btn btn-icon btn-ghost"
                  title="Resetear vista"
                >
                  üîÑ
                </button>
                <div class="toolbar-divider"></div>
                <button
                  id="btn-toggle-edit"
                  class="btn btn-sm btn-warning"
                  title="Activar modo edici√≥n"
                >
                  ‚úèÔ∏è Editar
                </button>
                <button
                  id="btn-clear-graph"
                  class="btn btn-icon btn-danger hidden"
                  title="Limpiar grafo"
                >
                  üóëÔ∏è
                </button>
              </div>
            </div>

            <div
              id="edit-mode-info"
              class="info-box info-box-warning mt-4 hidden"
            >
              <strong>‚úèÔ∏è Modo Edici√≥n Activo:</strong>
              <ul class="list-relaxed">
                <li>
                  <strong>Click en el canvas</strong> ‚Üí Agregar un nodo nuevo
                </li>
                <li>
                  <strong>Click derecho en un nodo</strong> ‚Üí Eliminar nodo
                </li>
                <li><strong>L√≠mite:</strong> M√°ximo 16 nodos permitidos</li>
              </ul>
            </div>

            <button
              id="btn-continue-execution"
              class="btn btn-primary btn-lg w-full mt-6 hidden"
            >
              Continuar ‚Üí
            </button>
          </section>

          <!-- SECCI√ìN 4: CONTROLES DE EJECUCI√ìN (Inicialmente oculta) -->
          <section id="controls-section" class="content-section hidden">
            <div class="section-header">
              <div>
                <div class="section-heading">
                  <div class="section-step-badge">4</div>
                  <h2 class="section-title">Ejecutar Algoritmo TSP</h2>
                </div>
                <p class="section-subtitle section-subtitle-offset">
                  Configura la velocidad y ejecuta la optimizaci√≥n
                </p>
              </div>
            </div>

            <div class="card mt-6">
              <div class="card-body">
                <label class="form-label mb-4">
                  <strong>‚ö° Velocidad de Ejecuci√≥n</strong>
                </label>

                <div class="speed-options mb-6">
                  <label class="speed-option">
                    <input
                      type="radio"
                      name="speed"
                      value="fast"
                      id="speed-fast"
                      class="input-hidden"
                    />
                    <div class="speed-card" data-speed="fast" id="btn-fast">
                      <div class="speed-icon">‚ö°</div>
                      <div class="speed-name">R√°pido</div>
                      <div class="speed-desc">500ms/paso</div>
                    </div>
                  </label>

                  <label class="speed-option">
                    <input
                      type="radio"
                      name="speed"
                      value="slow"
                      id="speed-slow"
                      checked
                      class="input-hidden"
                    />
                    <div
                      class="speed-card active"
                      data-speed="slow"
                      id="btn-slow"
                    >
                      <div class="speed-icon">üê¢</div>
                      <div class="speed-name">Lento</div>
                      <div class="speed-desc">1s/paso</div>
                    </div>
                  </label>

                  <label class="speed-option">
                    <input
                      type="radio"
                      name="speed"
                      value="manual"
                      id="speed-manual"
                      class="input-hidden"
                    />
                    <div
                      class="speed-card"
                      data-speed="manual"
                      id="btn-manual-step"
                    >
                      <div class="speed-icon">üëÜ</div>
                      <div class="speed-name">Manual</div>
                      <div class="speed-desc">Click/paso</div>
                    </div>
                  </label>
                </div>

                <div class="info-box info-box-warning mb-6">
                  <strong>‚ö†Ô∏è Recomendaci√≥n:</strong> Para N > 10, usa modo
                  <strong>Lento</strong> o <strong>Manual</strong> para evitar
                  congelamiento.
                </div>

                <div id="manual-controls" class="hidden mb-6">
                  <button id="btn-next-step" class="btn btn-outline w-full">
                    ‚û°Ô∏è Siguiente Paso
                  </button>
                </div>

                <button id="btn-execute" class="btn btn-xl w-full">
                  ‚ñ∂Ô∏è EJECUTAR ALGORITMO
                </button>
              </div>
            </div>

            <div id="execution-status" class="mt-4"></div>

            <div id="progress-container" class="hidden mt-6">
              <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
              </div>
              <div id="progress-text" class="progress-text">Progreso: 0%</div>
            </div>
          </section>

          <!-- SECCI√ìN 5: LOGS Y RESULTADOS (Inicialmente oculta) -->
          <section id="results-section" class="content-section hidden">
            <div class="section-header">
              <div class="flex-1">
                <div class="section-heading">
                  <div class="section-step-badge section-step-badge-success">
                    ‚úì
                  </div>
                  <h2 class="section-title">Resultados</h2>
                </div>
                <p class="section-subtitle section-subtitle-offset">
                  Registro detallado de la ejecuci√≥n y m√©tricas obtenidas
                </p>
              </div>
              <button id="btn-clear-logs" class="btn btn-outline btn-sm">
                üóëÔ∏è Limpiar
              </button>
            </div>

            <div class="logs-wrapper mt-6">
              <div class="logs-header">
                <span class="font-bold text-success-light"> ‚óè Terminal </span>
                <span class="text-xs text-neutral-400">
                  GreenCircuit v2.0
                </span>
              </div>
              <div id="log-container"></div>
            </div>
          </section>
        </div>
      </main>

      <!-- FOOTER COMPACTO -->
      <footer class="app-footer app-footer--compact">
        <div>
          <p class="text-secondary mb-0">
            üå± <strong>GreenCircuit</strong> - Optimizaci√≥n de Rutas TSP ¬∑ 2025
          </p>
        </div>
      </footer>
    </div>
    <!-- Fin del app-container -->

    <!-- JavaScript - Orden de carga importante (clases primero, luego app.js) -->
    <script src="src/js/Graph.js"></script>
    <script src="src/js/RandomGenerator.js"></script>
    <script src="src/js/HamiltonianFinder.js"></script>
    <script src="src/js/TSPSolver.js"></script>
    <script src="src/js/CytoscapeRenderer.js"></script>
    <script src="src/js/LogDisplay.js"></script>
    <script src="src/js/GraphEditor.js"></script>
    <script src="src/js/app.js"></script>
  </body>
</html>
